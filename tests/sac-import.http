### Get Access Token using Client Credentials Flow
# @name requestAccessToken
POST {{$dotenv sac_token_endpoint}}
Authorization: Basic {{$dotenv sac_clientid}}:{{$dotenv sac_clientsecret}}
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded

grant_type=client_credentials
#&response_type=token

### Fill Variables from Response
@access_token = {{requestAccessToken.response.body.$.access_token}}
### As /api/v1/csrf does not work we need to get the token from the /api/v1/dataimport/models endpoint
# @name getCSRF
HEAD {{$dotenv sac_endpoint}}/api/v1/dataimport/models
Authorization: Bearer {{access_token}}
x-csrf-token: fetch
### Read Token to Variable
@csrf={{getCSRF.response.headers.x-csrf-token}}

###
# @name requestModels
GET {{$dotenv sac_endpoint}}/api/v1/dataimport/models
Authorization: Bearer {{access_token}}
###
@modelID = {{requestModels.response.body.$.models[0].modelID}}
###
# @name requestModel
GET {{$dotenv sac_endpoint}}/api/v1/dataimport/models/{{modelID}}
Authorization: Bearer {{access_token}}
###
@factData = {{requestModel.response.body.$.importTypeUrls.factData}}
@masterData = {{requestModel.response.body.$.importTypeUrls.masterData}}
@masterFactData = {{requestModel.response.body.$.importTypeUrls.masterFactData}}
@metadataUrl = {{requestModel.response.body.$.metadataUrl}}
###
# @name requestFactData
GET {{factData}}
Authorization: Bearer {{access_token}}
###
# @name requestMasterData
GET {{masterData}}
Authorization: Bearer {{access_token}}
###
# @name requestMasterFactData
GET {{masterFactData}}
Authorization: Bearer {{access_token}}
###
# @name requestMetadata
GET {{metadataUrl}}
Authorization: Bearer {{access_token}}
